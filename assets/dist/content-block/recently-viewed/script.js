/*! For license information please see script.js.LICENSE.txt */
!function(){var e={4184:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var s=i.apply(null,n);s&&e.push(s)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var a in n)r.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},6808:function(e,t,n){var r,i;!function(o){if(void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i),!0,e.exports=o(),!!0){var s=window.Cookies,a=window.Cookies=o();a.noConflict=function(){return window.Cookies=s,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var l in o)o[l]&&(a+="; "+l,!0!==o[l]&&(a+="="+o[l].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),l=a.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(a[0]);if(l=(r.read||r)(l,c)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[c]=l,e===c)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){o(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))}))}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(6808),t=window.lodash;if("undefined"!=typeof cnViewing){let n=(()=>{let n=e.getJSON("cnRecentlyViewed");return(0,t.isArray)(n)||(n=[]),n})();0<=n.findIndex((e=>e.entryID===cnViewing.entryID))&&(0,t.remove)(n,(e=>e.entryID===cnViewing.entryID)),n.unshift(cnViewing),e.set("cnRecentlyViewed",(0,t.take)(n,10))}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=window.wp.element,o=window.wp.i18n,s=window.wp.apiFetch,a=n.n(s),l=window.wp.components,c=window.wp.url;var p=window.wp.compose;function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){const n=(0,t.groupBy)(e,"parent"),r=e=>e.map((e=>{const t=n[e.id];return d(d({},e),{},{children:t&&t.length?r(t):[]})}));return r(n[0]||[])}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const f={per_page:-1,orderby:"name",order:"asc",_fields:"id,name,parent"};class g extends i.Component{constructor(){super(...arguments),this.findTerm=this.findTerm.bind(this),this.onChange=this.onChange.bind(this),this.setFilterValue=this.setFilterValue.bind(this),this.sortBySelected=this.sortBySelected.bind(this),this.state={loading:!0,availableTermsTree:[],availableTerms:[],filterValue:"",filteredTermsTree:[]}}onChange(e){const{onChange:n,terms:r}=this.props;n(-1!==r.indexOf(e)?(0,t.without)(r,e):[...r,e])}findTerm(e,n,r){return(0,t.find)(e,(e=>(!e.parent&&!n||parseInt(e.parent)===parseInt(n))&&e.name.toLowerCase()===r.toLowerCase()))}componentDidMount(){this.fetchTerms()}componentWillUnmount(){(0,t.invoke)(this.fetchRequest,["abort"])}fetchTerms(){const{taxonomy:e}=this.props;e&&(this.fetchRequest=a()({path:(0,c.addQueryArgs)(`/cn-api/v1/${e}/`,f)}),this.fetchRequest.then((e=>{const t=this.sortBySelected(m(e));this.fetchRequest=null,this.setState({loading:!1,availableTermsTree:t,availableTerms:e})}),(e=>{"abort"!==e.statusText&&(this.fetchRequest=null,this.setState({loading:!1}))})))}sortBySelected(e){const{terms:t}=this.props,n=e=>{if(-1!==t.indexOf(e.id))return!0;if(void 0===e.children)return!1;return!!(e.children.map(n).filter((e=>e)).length>0)};return e.sort(((e,t)=>{const r=n(e),i=n(t);return r===i?0:r&&!i?-1:!r&&i?1:0})),e}setFilterValue(e){const{availableTermsTree:t}=this.state,n=e.target.value,r=t.map(this.getFilterMatcher(n)).filter((e=>e)),i=e=>{let t=0;for(let n=0;n<e.length;n++)t++,void 0!==e[n].children&&(t+=i(e[n].children));return t};this.setState({filterValue:n,filteredTermsTree:r});const s=i(r),a=(0,o.sprintf)((0,o._n)("%d result found.","%d results found.",s,"connections"),s);this.props.debouncedSpeak(a,"assertive")}getFilterMatcher(e){const t=n=>{if(""===e)return n;const i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);return i.children.length>0&&(i.children=i.children.map(t).filter((e=>e))),(-1!==i.name.toLowerCase().indexOf(e)||i.children.length>0)&&i};return t}renderTerms(e){const{terms:n=[]}=this.props;return e.map((e=>{e.id;return wp.element.createElement("div",{key:e.id,className:"editor-post-taxonomies__hierarchical-terms-choice cbd__hierarchical-terms-choice"},wp.element.createElement(l.CheckboxControl,{checked:-1!==n.indexOf(e.id),onChange:()=>{const t=parseInt(e.id,10);this.onChange(t)},label:(0,t.unescape)(e.name)}),!!e.children.length&&wp.element.createElement("div",{className:"editor-post-taxonomies__hierarchical-terms-subchoices"},this.renderTerms(e.children)))}))}render(){const{taxonomy:e,instanceId:n}=this.props,{availableTermsTree:r,availableTerms:i,filteredTermsTree:s,loading:a,filterValue:c}=this.state;if(a)return wp.element.createElement("p",null,wp.element.createElement(l.Spinner,null),(0,o.__)("Loading Data","connections"));const p=`editor-post-taxonomies__hierarchical-terms-filter-${n}`,u=(0,o.sprintf)((0,o._x)("Search %s","term","connections"),(0,t.startCase)(e)),d=(0,o.sprintf)((0,o._x)("Available %s","term","connections"),(0,t.startCase)(e)),m=i.length>=8;return[m&&wp.element.createElement("label",{key:"filter-label",htmlFor:p},u),m&&wp.element.createElement("input",{type:"search",id:p,value:c,onChange:this.setFilterValue,className:"editor-post-taxonomies__hierarchical-terms-filter",key:"term-filter-input"}),wp.element.createElement("div",{className:"editor-post-taxonomies__hierarchical-terms-list",key:"term-list",tabIndex:"0",role:"group","aria-label":d},this.renderTerms(""!==c?s:r))]}}(0,p.compose)([l.withSpokenMessages,p.withInstanceId])(g);function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}function w(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=window.wp.data;const v=["postType","postTypeMeta","label","value","noOptionLabel","options","onChange"];(0,b.withSelect)(((e,t)=>{const{getEntityRecords:n,getPostType:r}=e("core"),{getCurrentPostId:i}=e("core/editor"),o=void 0===t.postType?"page":t.postType,s=r(o),a=i();return{options:n("postType",o,{per_page:-1,exclude:a,parent_exclude:a,orderby:"title",order:"asc",_fields:"id,parent,title"}),postTypeMeta:s}}))((function(e){let{postType:n,postTypeMeta:r,label:i,value:s,noOptionLabel:a,options:c,onChange:p}=e,u=w(e,v);if(null===c)return wp.element.createElement("p",null,wp.element.createElement(l.Spinner,null),(0,o.__)("Loading Data","connections"));const d=(0,t.get)(r,["hierarchical"],!1),h=c||[];let f=[];return h.length?(f=d?m(h.map((e=>({id:e.id,parent:e.parent,name:e.title.raw?e.title.raw:`#${e.id} (${(0,o.__)("no title")})`})))):h.map((e=>({id:e.id,name:e.title.raw?e.title.raw:`#${e.id} (${(0,o.__)("no title")})`}))),wp.element.createElement(l.TreeSelect,y({className:"connections-directory--attributes__home_id",label:i,noOptionLabel:a,tree:f,selectedId:s,onChange:p},u))):null}));var O=n(4184),E=n.n(O);const _=["className","label","value","instanceId","onChange","beforeIcon","afterIcon","help","allowReset","initialPosition"];(0,p.withInstanceId)((function(e){let{className:n,label:r,value:i,instanceId:s,onChange:a,beforeIcon:c,afterIcon:p,help:u,allowReset:d,initialPosition:m}=e,h=w(e,_);const f=`inspector-range-control-${s}`,g=()=>a(),b=e=>{const t=e.target.value;""!==t?a(Number(t)):g()},v=(0,t.isFinite)(i)?i:m||"";return wp.element.createElement(l.BaseControl,{label:r,id:f,help:u,className:E()("components-range-control",n)},c&&wp.element.createElement(l.Dashicon,{icon:c}),wp.element.createElement("input",y({className:"components-range-control__slider",id:f,type:"range",value:v,onChange:b,"aria-describedby":u?f+"__help":void 0},h)),p&&wp.element.createElement(l.Dashicon,{icon:p}),wp.element.createElement("input",y({className:"components-range-control__number",type:"number",onChange:b,"aria-label":r,value:v},h)),d&&wp.element.createElement(l.Button,{onClick:g,disabled:void 0===i},(0,o.__)("Reset")))}));var x=window.wp.htmlEntities;class j extends i.Component{render(){const{asPermalink:e=!1,attributes:t,entry:n,tag:r}=this.props,i=r;let o=(0,x.decodeEntities)(n.fn.rendered);return e&&(o=wp.element.createElement("a",{href:n.link},o)),wp.element.createElement(i,null,o)}}var C=j;class P extends i.Component{render(){const{entry:e}=this.props;return(0,t.isUndefined)(e.job_title)||1>e.job_title.rendered.length?null:wp.element.createElement("div",{className:"title"},(0,x.decodeEntities)(e.job_title.rendered))}}var T=P;class S extends i.Component{render(){const{entry:e,size:n,type:r,usePlaceholder:i=!1,placeholderWidth:s=600,placeholderHeight:a=520}=this.props;if((0,t.has)(e.images,[r,n])){const{height:t,url:i,width:s}=e.images[r][n];return wp.element.createElement("span",{className:"cn-image-style"},wp.element.createElement("span",{style:{display:"block",maxWidth:"100%",width:`${s}px`}},wp.element.createElement("img",{className:"cn-image "+r,width:s,height:t,srcSet:i.replace(/^https?:/,"")+" 1x",alt:(0,o.sprintf)((0,o.__)("%s of %s","connections"),r.charAt(0).toUpperCase()+r.slice(1),(0,x.decodeEntities)(e.fn.rendered))})))}if(!0===i){let e={display:"inline-block",paddingBottom:`calc(${a} / ${s} * 100%)`,width:s+"px"};return wp.element.createElement("span",{className:"cn-image-"+r+" cn-image-none",style:e},wp.element.createElement("span",null,(0,o.__)("No Image Available","connections")))}return null}}var I=S;function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class A extends i.Component{constructor(e){super(e),this.prepareQueryArgs=this.prepareQueryArgs.bind(this),this.fetchAPI=this.fetchAPI.bind(this),this.fetchEntries=this.fetchEntries.bind(this),this.state={queryResults:[],isLoading:!0}}componentDidMount(){this.fetchEntries()}prepareQueryArgs(e){let t={};return t.exclude=this.props.exclude,t._images=[{type:"logo",size:"custom",width:600,height:520,zc:2},{type:"photo",size:"custom",width:600,height:520,zc:2}],t.per_page=this.props.limit,t._fields="type,fn.rendered,job_title.rendered,phone,email,social,excerpt.rendered,images,link",t=D(D({},t),e),t}fetchAPI(e){const t=(0,c.addQueryArgs)("/cn-api/v1/recently_viewed/",D(D({},e),{},{context:"view"}));return a()({path:t})}fetchEntries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fetchAPI(this.prepareQueryArgs(e)).then((e=>{this.setState({isLoading:!1,queryResults:e})}))}render(){let e=this.state.queryResults;if(Array.isArray(e)&&e.length){const t=e.filter((e=>document.URL!==e.link)).map(((e,t)=>wp.element.createElement("li",{key:t},wp.element.createElement("div",{className:"cn-recently-viewed-image"},wp.element.createElement(I,{entry:e,type:"organization"===e.type?"logo":"photo",size:"custom",usePlaceholder:!0})),wp.element.createElement("div",{className:"cn-recently-viewed-details"},wp.element.createElement(C,{entry:e,tag:"span",asPermalink:!0}),wp.element.createElement(T,{entry:e})))));return wp.element.createElement("ul",null,t)}return wp.element.createElement(i.Fragment,null,wp.element.createElement("div",null,this.state.isLoading?wp.element.createElement("p",null,(0,o.__)("Loading...","connections")," ",wp.element.createElement(l.Spinner,null)):wp.element.createElement("p",null,(0,o.__)("No recently viewed directory entries.","connections"))))}}document.querySelectorAll(".cn-recently-viewed").forEach((e=>{let t=e.getAttribute("data-limit"),n=e.getAttribute("data-exclude");(0,i.render)(wp.element.createElement(A,{limit:t,exclude:n}),e)}))}()}();
//# sourceMappingURL=script.js.map