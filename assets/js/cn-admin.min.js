jQuery(document).ready(function(a){var b={init:function(){var c;switch(1==a("input[name=entry_type]").length?c=a("input[name=entry_type]").val():a("input[name=entry_type]").length>1&&(c=a("input[name=entry_type]:checked").val()),c){case"individual":this.show(c);break;case"organization":this.show(c);break;case"family":this.show(c)}a("#submitdiv").on("click","input[name=entry_type][value=individual]",function(){b.show("individual")}),a("#submitdiv").on("click","input[name=entry_type][value=organization]",function(){b.show("organization")}),a("#submitdiv").on("click","input[name=entry_type][value=family]",function(){b.show("family")}),a("#cn-metabox-section-family").on("click","#add-relation",function(){b.relation()}),a(".postbox").on("click","a.cn-add.cn-button",function(c){b.add(a(this)),c.preventDefault()}),a(".postbox").on("click","a.cn-remove.cn-button",function(c){b.remove(a(this)),c.preventDefault()}),a.fn.chosen&&a(".cn-enhanced-select").chosen(),a.fn.datepicker&&a("body").on("focus",".cn-datepicker",function(){b.datepicker(a(this))}),a("#metabox-address").on("click","a.geocode.button",function(c){b.geocode(a(this)),c.preventDefault()}),window.FileReader&&window.File&&window.FileList&&window.Blob&&a('input[name="original_image"], input[name="original_logo"]').bind("change",function(){var b=a('input[name="original_image"]'),c=a('input[name="original_logo"]');if(cn_string.imageMaxFileSize<this.files[0].size){var d=a(this).attr("name"),e="original_image"==a(this).attr("name")?b.clone(!0):c.clone(!0);alert(cn_string.imageMaxFileSizeExceeded),"original_image"==d?b.replaceWith(e):c.replaceWith(e)}}),a("#metabox-meta").on("click","#newmeta-submit",function(a){b.add_meta(),a.preventDefault()}),a("#metabox-meta").on("click",'input[name^="deletemeta"]',function(c){b.delete_meta(a(this)),c.preventDefault()}),a("#metabox-meta").on("click","#enternew, #cancelnew",function(a){b.clear_meta(),a.preventDefault()}),a("#cn-relations").sortable(),b.validate(a("#cn-form"))},show:function(b){switch(b){case"individual":a("input[name=first_name], input[name=last_name]").addClass("required"),a("input[name=organization]").removeClass("required error").addClass("invalid"),a("input[name=family_name]").removeClass("required error").addClass("invalid"),a("#cn-metabox-section-name").slideDown(),a("#cn-metabox-section-title").slideDown(),a("#cn-metabox-section-organization").slideDown(),a("#cn-metabox-section-department").slideDown(),a("#cn-metabox-section-contact").slideUp(),a("#cn-metabox-section-family").slideUp();break;case"organization":a("input[name=organization]").addClass("required"),a("input[name=first_name], input[name=last_name]").removeClass("required error").addClass("invalid"),a("input[name=family_name]").removeClass("required error").addClass("invalid"),a("#cn-metabox-section-name").slideUp(),a("#cn-metabox-section-title").slideUp(),a("#cn-metabox-section-organization").slideDown(),a("#cn-metabox-section-department").slideDown(),a("#cn-metabox-section-contact").slideDown(),a("#cn-metabox-section-family").slideUp();break;case"family":a("input[name=family_name]").addClass("required"),a("input[name=first_name], input[name=last_name]").removeClass("required error").addClass("invalid"),a("input[name=organization]").removeClass("required error").addClass("invalid"),a("#cn-metabox-section-name").slideUp(),a("#cn-metabox-section-title").slideUp(),a("#cn-metabox-section-organization").slideUp(),a("#cn-metabox-section-department").slideUp(),a("#cn-metabox-section-contact").slideUp(),a("#cn-metabox-section-family").slideDown()}},add:function(b){var c=b.attr("data-type"),d="#"+b.attr("data-container"),e="#"+c+"-template",f=a(e).text(),g=new Date,h=Math.floor(Math.random()*g.getTime());f=f.replace(new RegExp("::FIELD::","gi"),h),a(d).append('<div class="widget '+c+'" id="'+c+"-row-"+h+'" style="display: none;">'+f+"</div>"),a("#"+c+"-row-"+h).slideDown()},remove:function(b){var c=b.attr("data-token"),d=b.attr("data-type"),e="#"+d+"-row-"+c;a(e).slideUp("fast",function(){a(e).remove()})},add_meta:function(){var b=a("#list-table").find("tbody tr:last-child"),c=b.clone(),d="-1"!==a("#metakeyselect").val()?a("#metakeyselect").val():a("#metakeyinput").val(),e=a("#metavalue").val();a("#metakeyinput, #metavalue").val(""),a("#metakeyselect option").eq(0).prop("selected",!0),c.find("input, textarea").attr("id",function(a,b){return b.replace(/(\d+)/,function(a,b){return Number(b)+1})}),c.find("input, textarea").attr("name",function(a,b){return b.replace(/(\d+)/,function(a,b){return Number(b)+1})}),c.find("label").attr("for",function(a,b){return b.replace(/(\d+)/,function(a,b){return Number(b)+1})}),c.find('input[name^="newmeta"]').val(d),c.find("textarea").val(e),a("#list-table").is(":visible")||a("#list-table").toggle(),c.toggle(),a("#the-list").append(c)},delete_meta:function(b){var c=b.closest("tr").toggle();c.find("textarea").val("::DELETED::"),a("#list-table").is(":visible")&&0==a("#list-table tbody tr:visible").length&&a("#list-table").toggle()},clear_meta:function(){a("#metakeyinput, #metakeyselect, #enternew, #cancelnew").toggle(),a("#metakeyselect option").eq(0).prop("selected",!0),a("#metakeyinput").val("")},chosen:function(a){a.chosen()},datepicker:function(a){a.datepicker({changeMonth:!0,changeYear:!0,showOtherMonths:!0,selectOtherMonths:!0,yearRange:"c-100:c+10"})},geocode:function(c){var d=new Object,e=c.attr("data-uid");d.line_1=a("input[name=address\\["+e+"\\]\\[line_1\\]]").val(),d.line_2=a("input[name=address\\["+e+"\\]\\[line_2\\]]").val(),d.line_3=a("input[name=address\\["+e+"\\]\\[line_3\\]]").val(),d.city=a("input[name=address\\["+e+"\\]\\[city\\]]").val(),d.state=a("input[name=address\\["+e+"\\]\\[state\\]]").val(),d.zipcode=a("input[name=address\\["+e+"\\]\\[zipcode\\]]").val(),d.country=a("input[name=address\\["+e+"\\]\\[country\\]]").val(),a("#map-"+e).fadeIn("slow",function(){a("#map-"+e).goMap({maptype:"ROADMAP"}),a.goMap.clearMarkers(),a.goMap.createMarker({address:"'"+d.line_1+", "+d.city+", "+d.state+", "+d.zipcode+", '",id:"baseMarker",draggable:!0}),a.goMap.setMap({address:"'"+d.line_1+", "+d.city+", "+d.state+", "+d.zipcode+", '",zoom:18}),a.goMap.createListener({type:"marker",marker:"baseMarker"},"idle",function(b){var c=b.latLng.lat(),d=b.latLng.lng();a("input[name=address\\["+e+"\\]\\[latitude\\]]").val(c),a("input[name=address\\["+e+"\\]\\[longitude\\]]").val(d)}),a.goMap.createListener({type:"marker",marker:"baseMarker"},"dragend",function(b){var c=b.latLng.lat(),d=b.latLng.lng();a("input[name=address\\["+e+"\\]\\[latitude\\]]").val(c),a("input[name=address\\["+e+"\\]\\[longitude\\]]").val(d)})}),setTimeout(function(){b.setGEO(e)},1500)},setGEO:function(b){var c=a("#map-"+b).data("baseMarker").getPosition();a("input[name=address\\["+b+"\\]\\[latitude\\]]").val(c.lat()),a("input[name=address\\["+b+"\\]\\[longitude\\]]").val(c.lng())},relation:function(){var b=a("#cn-relation-template").text(),c=new Date,d=Math.floor(Math.random()*c.getTime());b=b.replace(new RegExp("::FIELD::","gi"),d),a("#cn-relations").append('<li id="relation-row-'+d+'" class="cn-relation" style="display: none;"><i class="fa fa-sort"></i> '+b+'<a href="#" class="cn-remove cn-button button button-warning" data-type="relation" data-token="'+d+'">Remove</a></li>'),a("#relation-row-"+d).slideDown(),a(".cn-enhanced-select").chosen()},validate:function(a){a.validate({errorPlacement:function(){},ignore:'ul.chosen-choices li.search-field input, textarea[id$="template"]'})}};b.init(),a("a.detailsbutton").click(function(){var b=a(this);b.text(b.text()==cn_string.showDetails?cn_string.hideDetails:cn_string.showDetails).attr("title",b.attr("title")==cn_string.showDetailsTitle?cn_string.hideDetailsTitle:cn_string.showDetailsTitle),a(".child-"+this.id).each(function(b,c){a(c).toggle()})})});