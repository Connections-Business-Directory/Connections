jQuery(document).ready(function(b){var a={init:function(){var c;if(b("input[name=entry_type]").length==1){c=(b("input[name=entry_type]").val());}else{if(b("input[name=entry_type]").length>1){c=(b("input[name=entry_type]:checked").val());
}}switch(c){case"individual":this.show(c);break;case"organization":this.show(c);break;case"family":this.show(c);break;}b("#submitdiv").on("click","input[name=entry_type][value=individual]",function(){a.show("individual");
});b("#submitdiv").on("click","input[name=entry_type][value=organization]",function(){a.show("organization");});b("#submitdiv").on("click","input[name=entry_type][value=family]",function(){a.show("family");
});b("#cn-metabox-section-family").on("click","#add-relation",function(){a.relation();});b(".postbox").on("click","a.cn-add.cn-button",function(d){a.add(b(this));
d.preventDefault();});b(".postbox").on("click","a.cn-remove.cn-button",function(d){a.remove(b(this));d.preventDefault();});if(b.fn.chosen){b(".cn-enhanced-select").chosen();
}if(b.fn.datepicker){b("body").on("focus",".cn-datepicker",function(){a.datepicker(b(this));});}b("#metabox-address").on("click","a.geocode.button",function(d){a.geocode(b(this));
d.preventDefault();});b("#metabox-meta").on("click","#newmeta-submit",function(d){a.add_meta();d.preventDefault();});b("#metabox-meta").on("click",'input[name^="deletemeta"]',function(d){a.delete_meta(b(this));
d.preventDefault();});b("#metabox-meta").on("click","#enternew, #cancelnew",function(d){a.clear_meta();d.preventDefault();});a.validate(b("#cn-form"));
},show:function(c){switch(c){case"individual":b("input[name=first_name], input[name=last_name]").addClass("required");b("input[name=organization]").removeClass("required error").addClass("invalid");
b("input[name=family_name]").removeClass("required error").addClass("invalid");b("#cn-metabox-section-name").slideDown();b("#cn-metabox-section-title").slideDown();
b("#cn-metabox-section-organization").slideDown();b("#cn-metabox-section-department").slideDown();b("#cn-metabox-section-contact").slideUp();b("#cn-metabox-section-family").slideUp();
break;case"organization":b("input[name=organization]").addClass("required");b("input[name=first_name], input[name=last_name]").removeClass("required error").addClass("invalid");
b("input[name=family_name]").removeClass("required error").addClass("invalid");b("#cn-metabox-section-name").slideUp();b("#cn-metabox-section-title").slideUp();
b("#cn-metabox-section-organization").slideDown();b("#cn-metabox-section-department").slideDown();b("#cn-metabox-section-contact").slideDown();b("#cn-metabox-section-family").slideUp();
break;case"family":b("input[name=family_name]").addClass("required");b("input[name=first_name], input[name=last_name]").removeClass("required error").addClass("invalid");
b("input[name=organization]").removeClass("required error").addClass("invalid");b("#cn-metabox-section-name").slideUp();b("#cn-metabox-section-title").slideUp();
b("#cn-metabox-section-organization").slideUp();b("#cn-metabox-section-department").slideUp();b("#cn-metabox-section-contact").slideUp();b("#cn-metabox-section-family").slideDown();
break;}},add:function(f){var h=f.attr("data-type");var c="#"+f.attr("data-container");var j="#"+h+"-template";var g=b(j).text();var i=new Date();var e=Math.floor(Math.random()*i.getTime());
g=g.replace(new RegExp("::FIELD::","gi"),e);b(c).append('<div class="widget '+h+'" id="'+h+"-row-"+e+'" style="display: none;">'+g+"</div>");b("#"+h+"-row-"+e).slideDown();
},remove:function(d){var c=d.attr("data-token");var e=d.attr("data-type");var f="#"+e+"-row-"+c;b(f).slideUp("fast",function(){b(f).remove();});},add_meta:function(){var e=b("#list-table").find("tbody tr:last-child");
var f=e.clone();var c=b("#metakeyselect").val()!=="-1"?b("#metakeyselect").val():b("#metakeyinput").val();var d=b("#metavalue").val();b("#metakeyinput, #metavalue").val("");
b("#metakeyselect option").eq(0).prop("selected",true);f.find("input, textarea").attr("id",function(g,h){return h.replace(/(\d+)/,function(i,j){return Number(j)+1;
});});f.find("input, textarea").attr("name",function(h,g){return g.replace(/(\d+)/,function(i,j){return Number(j)+1;});});f.find("label").attr("for",function(h,g){return g.replace(/(\d+)/,function(i,j){return Number(j)+1;
});});f.find('input[name^="newmeta"]').val(c);f.find("textarea").val(d);if(!b("#list-table").is(":visible")){b("#list-table").toggle();}f.toggle();b("#the-list").append(f);
},delete_meta:function(d){var c=d.closest("tr").toggle();c.find("textarea").val("::DELETED::");if(b("#list-table").is(":visible")){if(b("#list-table tbody tr:visible").length==0){b("#list-table").toggle();
}}},clear_meta:function(){b("#metakeyinput, #metakeyselect, #enternew, #cancelnew").toggle();b("#metakeyselect option").eq(0).prop("selected",true);b("#metakeyinput").val("");
},chosen:function(c){c.chosen();},datepicker:function(c){c.datepicker({changeMonth:true,changeYear:true,showOtherMonths:true,selectOtherMonths:true,yearRange:"c-100:c+10"});
},geocode:function(g){var c=new Object();var f;var d;var e=g.attr("data-uid");c.line_1=b("input[name=address\\["+e+"\\]\\[line_1\\]]").val();c.line_2=b("input[name=address\\["+e+"\\]\\[line_2\\]]").val();
c.line_3=b("input[name=address\\["+e+"\\]\\[line_3\\]]").val();c.city=b("input[name=address\\["+e+"\\]\\[city\\]]").val();c.state=b("input[name=address\\["+e+"\\]\\[state\\]]").val();
c.zipcode=b("input[name=address\\["+e+"\\]\\[zipcode\\]]").val();c.country=b("input[name=address\\["+e+"\\]\\[country\\]]").val();b("#map-"+e).fadeIn("slow",function(){b("#map-"+e).goMap({maptype:"ROADMAP"});
b.goMap.clearMarkers();b.goMap.createMarker({address:"'"+c.line_1+", "+c.city+", "+c.state+", "+c.zipcode+", '",id:"baseMarker",draggable:true});b.goMap.setMap({address:"'"+c.line_1+", "+c.city+", "+c.state+", "+c.zipcode+", '",zoom:18});
b.goMap.createListener({type:"marker",marker:"baseMarker"},"idle",function(i){var j=i.latLng.lat();var h=i.latLng.lng();b("input[name=address\\["+e+"\\]\\[latitude\\]]").val(j);
b("input[name=address\\["+e+"\\]\\[longitude\\]]").val(h);});b.goMap.createListener({type:"marker",marker:"baseMarker"},"dragend",function(i){var j=i.latLng.lat();
var h=i.latLng.lng();b("input[name=address\\["+e+"\\]\\[latitude\\]]").val(j);b("input[name=address\\["+e+"\\]\\[longitude\\]]").val(h);});});setTimeout(function(){a.setGEO(e);
},1500);},setGEO:function(d){var c=b("#map-"+d).data("baseMarker").getPosition();b("input[name=address\\["+d+"\\]\\[latitude\\]]").val(c.lat());b("input[name=address\\["+d+"\\]\\[longitude\\]]").val(c.lng());
},relation:function(){var e=(b("#cn-relation-template").text());var f=new Date();var c=Math.floor(Math.random()*f.getTime());e=e.replace(new RegExp("::FIELD::","gi"),c);
b("#cn-relations").append('<div id="relation-row-'+c+'" class="relation" style="display: none;">'+e+'<a href="#" class="cn-remove cn-button button button-warning" data-type="relation" data-token="'+c+'">Remove</a></div>');
b("#relation-row-"+c).slideDown();b(".cn-enhanced-select").chosen();},validate:function(c){c.validate({errorPlacement:function(d,e){},ignore:'ul.chosen-choices li.search-field input, textarea[id$="template"]'});
}};a.init();b("a.detailsbutton").click(function(){var c=b(this);c.text(c.text()==cn_string.showDetails?cn_string.hideDetails:cn_string.showDetails).attr("title",c.attr("title")==cn_string.showDetailsTitle?cn_string.hideDetailsTitle:cn_string.showDetailsTitle);
b(".child-"+this.id).each(function(d,e){b(e).toggle();});});});