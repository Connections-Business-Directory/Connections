jQuery(document).ready((function($){var CN_System_Tools={init:function(){this.setupValidation(),$("body").on("click","#cn-send-system-info-submit",(function(e){e.preventDefault();var id="#cn-send-system-info";return CN_System_Tools.clearValidationErrorMessages(id),CN_System_Tools.isValid(id)&&CN_System_Tools.send(id),!1})),$('input[name="generate-url"]').on("click",(function(e){return e.preventDefault(),CN_System_Tools.generateURL(this),!1})),$('input[name="revoke-url"]').on("click",(function(e){return e.preventDefault(),CN_System_Tools.revokeURL(this),!1})),$("#cn-import-settings").ajaxForm({type:"post",dataType:"json",url:ajaxurl,beforeSubmit:function(arr,$form,options){$("#cn-import-settings-submit").attr("disabled","disabled")},success:function(response,status,jqXHR){CN_System_Tools.ajaxSuccess("#cn-import-settings-response",response.data.message,status,jqXHR),$('#cn-import-settings input[name="import_file"]').val(""),$("#cn-import-settings-submit").removeAttr("disabled")},error:function(XMLHttpRequest,status,error){CN_System_Tools.ajaxError("#cn-import-settings-response",XMLHttpRequest.responseJSON.data.message,status,error),$("#cn-import-settings-submit").removeAttr("disabled"),$('#cn-import-settings input[name="import_file"]').val("")}})},setupValidation:function(){$.validator.setDefaults({rules:{email:{required:!0,email:!0},subject:"required",message:"required"},messages:{email:"<p>"+cn_system_info.strErrMsgMissingEmail+"</p>",subject:"<p>"+cn_system_info.strErrMsgMissingSubject+"</p>",message:"<p>"+cn_system_info.strErrMsgMissingMessage+"</p>"},errorElement:"div",errorPlacement:function(error,element){error.insertBefore(element)},debug:!0})},clearValidationErrorMessages:function(id){$(id+" label.error").remove()},isValid:function(id){return $(id).valid()},data:function(id){var email,subject,message,action,nonce;return{email:$(id+" #cn-email-address").val(),subject:$(id+" #cn-email-subject").val(),message:$(id+" #cn-email-message").val(),action:$(id+' [name="action"]').val(),_cnonce:$(id+' [name="_cnonce"]').val()}},send:function(id){$(id+" #cn-send-system-info-submit").attr("disabled","disabled").val(cn_system_info.strSending).promise().done((function(){$.when($.ajax({type:"post",url:ajaxurl,dataType:"json",data:CN_System_Tools.data(id),cache:!1,success:function(response,status,jqXHR){CN_System_Tools.ajaxSuccess("#cn-email-response",response.data.message,status,jqXHR)},error:function(XMLHttpRequest,status,error){CN_System_Tools.ajaxError("#cn-email-response",XMLHttpRequest.responseJSON.data.message,status,error)}})).then((function(){CN_System_Tools.clearForm(id)})).fail((function(){CN_System_Tools.clearForm(id)}))}))},generateURL:function(object){var wp;window.wp.ajax.send("generate_url",{success:function(response){$("#system-info-url").val(response.url),$("#system-info-url-text-link").attr("href",response.url).css("display","inline-block"),CN_System_Tools.ajaxSuccess("#cn-remote-response",response.message)},error:function(response){CN_System_Tools.ajaxSuccess("#cn-remote-response",response.message)},data:{_cnonce:$(object).data("nonce")}})},revokeURL:function(object){var wp;window.wp.ajax.send("revoke_url",{success:function(response){$("#system-info-url").val(""),$("#system-info-url-text-link").attr("href","#").css("display","none"),CN_System_Tools.ajaxSuccess("#cn-remote-response",response.message)},error:function(response){CN_System_Tools.ajaxSuccess("#cn-remote-response",response.message)},data:{_cnonce:$(object).data("nonce")}})},ajaxSuccess:function(id,message,status,jqXHR){switch(message){case-3:CN_System_Tools.showMessage(id,cn_system_info.strAJAXHeaderErrMsg);break;case-2:CN_System_Tools.showMessage(id,cn_system_info.strErrMsgUserNotPermitted);break;case-1:case 0:CN_System_Tools.showMessage(id,cn_system_info.strErrMsgAction);break;case 1:CN_System_Tools.showMessage(id,cn_system_info.strSubmitted);break;default:CN_System_Tools.showMessage(id,message)}},ajaxError:function(id,message,status,error){CN_System_Tools.showMessage(id,message)},clearForm:function(id){$(id+" #cn-email-address").val(""),$(id+" #cn-email-subject").val(""),$(id+" #cn-email-message").val(""),$(id+" #cn-send-system-info-submit").removeAttr("disabled").val(cn_system_info.strSend)},showMessage:function(id,message){$(id).html('<div class="notice notice-warning"><p>'+message+"</p></div>").slideDown("slow").animate({opacity:1},1500).delay(1500).slideUp("slow")}};CN_System_Tools.init()}));