jQuery(document).ready(function(a){var b={init:function(){this.setupValidation(),a("body").on("click","#cn-send-system-info-submit",function(a){a.preventDefault();var c="#cn-send-system-info";return b.clearValidationErrorMessages(c),b.isValid(c)&&b.send(c),!1}),a('input[name="generate-url"]').on("click",function(a){return a.preventDefault(),b.generateURL(this),!1}),a('input[name="revoke-url"]').on("click",function(a){return a.preventDefault(),b.revokeURL(this),!1}),a("#cn-import-settings").ajaxForm({type:"post",dataType:"json",url:ajaxurl,beforeSubmit:function(){a("#cn-import-settings-submit").attr("disabled","disabled")},success:function(c,d,e){b.ajaxSuccess("#cn-import-settings-response",c,d,e),a('#cn-import-settings input[name="import_file"]').val(""),a("#cn-import-settings-submit").removeAttr("disabled")},error:function(c,d,e){b.ajaxError("#cn-import-settings-response",c,d,e),a("#cn-import-settings-submit").removeAttr("disabled"),a('#cn-import-settings input[name="import_file"]').val("")}})},setupValidation:function(){a.validator.setDefaults({rules:{email:{required:!0,email:!0},subject:"required",message:"required"},messages:{email:"<p>"+cn_system_info.strErrMsgMissingEmail+"</p>",subject:"<p>"+cn_system_info.strErrMsgMissingSubject+"</p>",message:"<p>"+cn_system_info.strErrMsgMissingMessage+"</p>"},errorElement:"div",errorPlacement:function(a,b){a.insertBefore(b)},debug:!0})},clearValidationErrorMessages:function(b){a(b+" label.error").remove()},isValid:function(b){return a(b).valid()},data:function(b){var c=a(b+" #cn-email-address").val(),d=a(b+" #cn-email-subject").val(),e=a(b+" #cn-email-message").val(),f=a(b+' [name="action"]').val(),g=a(b+' [name="_cn_wpnonce"]').val();return{email:c,subject:d,message:e,action:f,nonce:g}},send:function(c){a(c+" #cn-send-system-info-submit").attr("disabled","disabled").val(cn_system_info.strSending).promise().done(function(){a.when(a.ajax({type:"post",url:ajaxurl,dataType:"json",data:b.data(c),cache:!1,success:function(a,c,d){b.ajaxSuccess("#cn-email-response",a,c,d)},error:function(a,c,d){b.ajaxError("#cn-email-response",a,c,d)}})).then(function(){b.clearForm(c)})})},generateURL:function(c){var d=window.wp;d.ajax.send("generate_url",{success:function(c){a("#system-info-url").val(c.url),a("#system-info-url-text-link").attr("href",c.url).css("display","inline-block"),b.ajaxSuccess("#cn-remote-response",c.message)},error:function(a){b.ajaxSuccess("#cn-remote-response",a)},data:{_ajax_nonce:a(c).data("nonce")}})},revokeURL:function(c){var d=window.wp;d.ajax.send("revoke_url",{success:function(c){a("#system-info-url").val(""),a("#system-info-url-text-link").attr("href","#").css("display","none"),b.ajaxSuccess("#cn-remote-response",c)},error:function(a){b.ajaxSuccess("#cn-remote-response",a)},data:{_ajax_nonce:a(c).data("nonce")}})},ajaxSuccess:function(a,c){switch(c){case-3:b.showMessage(a,cn_system_info.strAJAXHeaderErrMsg);break;case-2:b.showMessage(a,cn_system_info.strErrMsgUserNotPermitted);break;case-1:b.showMessage(a,cn_system_info.strErrMsgAction);break;case 0:b.showMessage(a,cn_system_info.strErrMsgAction);break;case 1:b.showMessage(a,cn_system_info.strSubmitted);break;default:b.showMessage(a,c)}},ajaxError:function(a){b.showMessage(a,cn_system_info.strAJAXSubmitErrMsg)},clearForm:function(b){a(b+" #cn-email-address").val(""),a(b+" #cn-email-subject").val(""),a(b+" #cn-email-message").val(""),a(b+" #cn-send-system-info-submit").removeAttr("disabled").val(cn_system_info.strSend)},showMessage:function(b,c){a(b).html('<div class="notice notice-warning"><p>'+c+"</p></div>").slideDown("slow").animate({opacity:1},1500).delay(1500).slideUp("slow")}};b.init()});